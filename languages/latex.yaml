rules:
    whitespace:
        pattern: "space+"
        capture: whitespace
    line_comment:
        pattern: "'%' (!'\n' .)*"
    block_comment:
        pattern: >-
            '\\begin' ' '* '{comment}' (!('\\end' ' '* '{comment}') .) ('\\end' ' '* '{comment}')?
    comment:
        pattern: "block_comment / line_comment"
        capture: comment
    section_name:
        words: [
            'part', 'chapter', 'section', 'subsection', 'subsubsection', 'paragraph',
            'subparagraph'
        ]
    section:
        pattern: >-
            '\\' section_name '*'?
        capture: special
    math_word:
        words: [
            'align', 'displaymath', 'eqnarray', 'equation', 'gather', 'math', 'multline'
        ]
    math_begin_end:
        pattern: >-
            ('begin' / 'end') ' '* '{' math_word '*'? '}'
    math:
        pattern: >-
            '$' / '\\' ([\[\]()] / math_begin_end)
        capture: type
    environment:
        pattern: >-
            '\\' ('begin' / 'end') ' '* '{' word '*'? '}'
        capture: class
    command:
        pattern: >-
            '\\' (alpha+ / [#$&~_^%{}])
        capture: keyword
    operator:
        pattern: "[&#{}\\[\\]]"
        capture: operator
tokens:
    - whitespace
    - comment
    - math
    - environment
    - section
    - command
    - operator
